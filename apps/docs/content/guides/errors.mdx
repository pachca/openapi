---
title: Ошибки и лимиты
description: Коды ошибок HTTP и rate limits
---

# Ошибки и лимиты

## Коды

Мы используем обычные коды ответов `HTTP` для обозначения результата выполнения запроса.

Коды группы `2**` указывают на успех. Коды группы `4**` указывают на ошибку запроса, который не удался с учетом предоставленной информации (например, обязательный параметр был пропущен, несуществующий идентификатор и др.). Коды группы `5**` указывают на ошибки на серверах Пачки (они редки).

<HttpCodes />

## Пояснения ошибки

В зависимости от типа ошибки вы получите в теле ответа одну из следующих структур:

- **ApiError** — для кодов `400`, `403`, `404`, `409`, `410`, `422`. Содержит массив `errors` с детальной информацией об ошибках.
- **OAuthError** — для кода `401`. Содержит поля `error` и `error_description` с информацией об ошибке авторизации.

<ErrorSchema />

## Лимиты

Мы следим за стабильностью API, поэтому есть лимиты на запросы (rate limiting). Они гибкие, зависят от нагрузки, но мы сделали их комфортными — должно хватить для любых ваших задач.

<Limit 
  title="Входящие вебхуки"
  limit="~4 запроса"
  period="1 секунда"
  howItWorks="Лимит привязан к идентификатору вебхука в пути. <div class='text-text-secondary'>Например, для <code class='text-text-secondary!'>&#47;webhooks/user123</code> считаем по <code class='text-text-secondary!'>user123</code></div>"
/>

Если за секунду отправите больше 2 запросов на один идентификатор, лишние получат `429 Too Many Requests`. В заголовке `Retry-After` мы укажем, через сколько секунд можно попробовать снова.

### API

<Limit 
  title="Отправка, изменение и удаление сообщений"
  limit="~4 запроса"
  period="1 секунда"
  entity="chat_id"
  howItWorks="Считаем по токену авторизации (заголовок <code>HTTP_AUTHORIZATION</code>). Один токен — один лимит. <span class='text-text-secondary'>Запросы учитываются по каждому чату отдельно. Дополнительно, допускаются короткие ускорения выше указанного лимита отправки сообщений: до 30 запросов в секунду на протяжении 5 секунд в каждый чат.</span>"
/>

<Limit 
  title="Получение сообщений"
  limit="~10 запросов"
  period="1 секунда"
  howItWorks="Считаем по токену авторизации (заголовок <code>HTTP_AUTHORIZATION</code>). Один токен — один лимит."
/>

<Limit 
  title="Остальные методы API"
  limit="~50 запросов"
  period="1 секунда"
  howItWorks="Считаем по токену авторизации (заголовок <code>HTTP_AUTHORIZATION</code>). Один токен — один лимит."
/>

Если за секунду будет больше указанных запросов с одним токеном, API вернёт `429 Too Many Requests`. В заголовке `Retry-After` мы укажем, через сколько секунд можно попробовать снова.

- **Лимиты гибкие:** они ориентировочные и могут меняться, чтобы всё работало гладко;
- **Должно хватать на всё:** мы настроили их так, чтобы вам было комфортно в любых сценариях;
- **Если упёрлись в лимит:** при ошибке `429` смотрите заголовок `Retry-After` — он подскажет, через сколько секунд повторить запрос (или используйте экспоненциальный `backoff`, если хотите перестраховаться).
