export interface SkillError {
  code: number | string;
  reason: string;
  action: string;
}

export interface SkillConfig {
  name: string;
  tags: string[];
  description: string;
  triggers: string[];
  negativeTriggers: string[];
  guides?: string[];
  errors?: SkillError[];
  botOnly?: boolean;
}

export const SKILL_TAG_MAP: SkillConfig[] = [
  {
    name: 'pachca-profile',
    tags: ['Profile'],
    description:
      'Получение и обновление профиля текущего пользователя, управление статусом, кастомные поля сотрудников. Используй когда нужно: получить свой профиль, обновить статус, узнать дополнительные поля. НЕ используй для: управления другими сотрудниками (→ pachca-users).',
    triggers: [
      'получить профиль',
      'мой профиль',
      'установить статус',
      'обновить статус',
      'сбросить статус',
      'кастомные поля',
      'дополнительные поля',
    ],
    negativeTriggers: ['управление сотрудниками', 'создать пользователя', 'список сотрудников'],
  },
  {
    name: 'pachca-users',
    tags: ['Users', 'Group tags'],
    description:
      'Управление сотрудниками и тегами (группами). Создание, обновление, удаление, поиск сотрудников. Онбординг и offboarding. Создание и управление тегами. Используй когда нужно: найти сотрудника, создать пользователя, онбординг/offboarding, управлять тегами. НЕ используй для: собственного профиля (→ pachca-profile).',
    triggers: [
      'найти сотрудника',
      'создать пользователя',
      'список сотрудников',
      'создать тег',
      'управлять тегами',
      'назначить тег',
      'приостановить сотрудника',
      'онбординг',
      'offboarding',
      'уволить сотрудника',
      'участники тега',
    ],
    negativeTriggers: ['мой профиль', 'обновить статус'],
  },
  {
    name: 'pachca-chats',
    tags: ['Chats', 'Members'],
    description:
      'Управление каналами и беседами, участниками чатов. Создание, обновление, архивация чатов. Добавление/удаление участников, роли, экспорт сообщений. Используй когда нужно: создать канал, добавить участника, архивировать чат, найти активные/неактивные чаты, экспорт сообщений. НЕ используй для: отправки сообщений (→ pachca-messages).',
    triggers: [
      'создать канал',
      'создать беседу',
      'создать чат',
      'добавить участника',
      'удалить участника',
      'архивировать чат',
      'роли участников',
      'экспорт сообщений',
      'список чатов',
      'активные чаты',
      'неактивные чаты',
    ],
    negativeTriggers: ['отправить сообщение', 'ответить в тред', 'загрузить файл'],
    guides: ['export'],
  },
  {
    name: 'pachca-messages',
    tags: ['Messages', 'Thread', 'Reactions', 'Read member'],
    description:
      'Отправка сообщений в каналы, беседы и личные чаты Пачки. Ответы в треды, загрузка файлов, кнопки, реакции, закрепление, прочтения. Используй когда нужно: отправить сообщение, ответить в тред, прикрепить файл, добавить реакцию, получить историю чата, закрепить сообщение. НЕ используй для: создания каналов (→ pachca-chats), управления ботами (→ pachca-bots).',
    triggers: [
      'отправить сообщение',
      'ответить в тред',
      'прикрепить файл',
      'загрузить файл',
      'вложения сообщения',
      'добавить реакцию',
      'история сообщений',
      'закрепить сообщение',
      'редактировать сообщение',
      'удалить сообщение',
      'подписаться на тред',
      'разослать уведомление',
      'упомянуть пользователя',
      'кнопки',
      'прочтения',
      'личное сообщение',
    ],
    negativeTriggers: [
      'создать канал',
      'управлять участниками',
      'настроить бота',
      'вебхук',
      'форма',
    ],
  },
  {
    name: 'pachca-bots',
    tags: ['Bots', 'Link Previews'],
    description:
      'Управление ботами, входящие/исходящие вебхуки, разворачивание ссылок (unfurling). Используй когда нужно: настроить бота, обработать вебхук, обработать нажатие кнопки, периодический дайджест, алерты, polling событий, развернуть ссылку. НЕ используй для: отправки сообщений от бота (→ pachca-messages), интерактивных форм (→ pachca-forms).',
    triggers: [
      'настроить бота',
      'вебхук',
      'webhook',
      'обработать событие',
      'подпись вебхука',
      'нажатие кнопки',
      'callback',
      'дайджест',
      'алерт',
      'polling',
      'unfurl',
      'развернуть ссылку',
      'link preview',
    ],
    negativeTriggers: ['отправить сообщение', 'показать форму', 'интерактивная форма'],
    guides: ['webhook'],
  },
  {
    name: 'pachca-forms',
    tags: ['Views'],
    description:
      'Интерактивные формы с полями ввода и кнопками для ботов. Используй когда нужно: показать форму, обработать submit формы, валидировать поля формы, создать модальное окно, опрос сотрудников. НЕ используй для: обычных кнопок в сообщениях (→ pachca-messages), настройки бота (→ pachca-bots).',
    triggers: [
      'показать форму',
      'интерактивная форма',
      'модальное окно',
      'modal',
      'submit формы',
      'обработать отправку формы',
      'валидация формы',
      'view_submission',
      'опрос',
      'заявка через форму',
    ],
    negativeTriggers: ['кнопки в сообщении', 'настроить бота', 'вебхук'],
    guides: ['forms'],
    botOnly: true,
    errors: [
      {
        code: 410,
        reason: 'trigger_id истёк или не найден',
        action: 'trigger_id действует 3 секунды. Получи новый через нажатие кнопки (вебхук)',
      },
    ],
  },
  {
    name: 'pachca-tasks',
    tags: ['Tasks'],
    description:
      'Создание, получение, обновление и удаление задач (напоминаний). Используй когда нужно: создать задачу, получить список задач, обновить задачу, удалить задачу.',
    triggers: [
      'создать задачу',
      'список задач',
      'напоминание',
      'обновить задачу',
      'отметить задачу выполненной',
      'удалить задачу',
      'кастомные поля задачи',
    ],
    negativeTriggers: ['отправить сообщение', 'управлять чатом'],
  },
  {
    name: 'pachca-security',
    tags: ['Security'],
    description:
      'Журнал аудита событий и DLP-система. Используй когда нужно: получить журнал аудита, просмотреть события безопасности, настроить DLP. НЕ используй для: обычных API-запросов (→ другие скиллы). Требует тариф «Корпорация».',
    triggers: [
      'аудит',
      'журнал событий',
      'безопасность',
      'DLP',
      'логи',
      'подозрительные входы',
      'история входов',
    ],
    negativeTriggers: ['отправить сообщение', 'управлять пользователями'],
    guides: ['dlp', 'audit-events'],
  },
];

export const COMMON_ENDPOINT_MAP: Record<string, string> = {
  '/custom_properties': 'pachca-profile',
  '/uploads': 'pachca-messages',
  '/direct_url': 'pachca-messages',
  '/chats/exports': 'pachca-chats',
  '/chats/exports/{id}': 'pachca-chats',
};
