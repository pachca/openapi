---
name: pachca-bots
description: >
  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏, –≤—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ –≤–µ–±—Ö—É–∫–∏, —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫
  (unfurling). –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ: –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–æ—Ç–∞, –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤–µ–±—Ö—É–∫, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
  –ø–æ–¥–ø–∏—Å—å –≤–µ–±—Ö—É–∫–∞, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å—Å—ã–ª–∫—É. –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –¥–ª—è: –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –±–æ—Ç–∞
  (‚Üí pachca-messages), –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–æ—Ä–º (‚Üí pachca-forms).
---

# –ë–æ—Ç—ã –∏ Webhook

Base URL: `https://api.pachca.com/api/shared/v1`
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: `Authorization: Bearer <ACCESS_TOKEN>`
–¢–æ–∫–µ–Ω: –±–æ—Ç (–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ ‚Üí –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚Üí API) –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ ‚Üí API).

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–æ—Ç–∞
- –≤–µ–±—Ö—É–∫
- webhook
- –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ
- –ø–æ–¥–ø–∏—Å—å –≤–µ–±—Ö—É–∫–∞
- unfurl
- —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å—Å—ã–ª–∫—É
- link preview

## –ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å, –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å, –º–æ–π –ø—Ä–æ—Ñ–∏–ª—å ‚Üí **pachca-profile**
- –Ω–∞–π—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ ‚Üí **pachca-users**
- —Å–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª, —Å–æ–∑–¥–∞—Ç—å –±–µ—Å–µ–¥—É, —Å–æ–∑–¥–∞—Ç—å —á–∞—Ç ‚Üí **pachca-chats**
- –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–≤–µ—Ç–∏—Ç—å –≤ —Ç—Ä–µ–¥, –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª ‚Üí **pachca-messages**
- –ø–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º–∞, –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ ‚Üí **pachca-forms**
- —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É, —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ ‚Üí **pachca-tasks**
- –∞—É–¥–∏—Ç, –∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí **pachca-security**

## –ü–æ—à–∞–≥–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–æ—Ç–∞ —Å –∏—Å—Ö–æ–¥—è—â–∏–º –≤–µ–±—Ö—É–∫–æ–º

1. –°–æ–∑–¥–∞–π –±–æ—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –ü–∞—á–∫–∏: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ ‚Üí –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚Üí Webhook
2. –ü–æ–ª—É—á–∏ access_token –±–æ—Ç–∞ –≤–æ –≤–∫–ª–∞–¥–∫–µ ¬´API¬ª –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞
3. –£–∫–∞–∂–∏ Webhook URL –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
4. –í—ã–±–µ—Ä–∏ —Ç–∏–ø—ã —Å–æ–±—ã—Ç–∏–π: –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —Ä–µ–∞–∫—Ü–∏–∏, –∫–Ω–æ–ø–∫–∏, —É—á–∞—Å—Ç–Ω–∏–∫–∏

> –ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ UI, –Ω–µ —á–µ—Ä–µ–∑ API. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –±–æ—Ç–æ–≤ ‚Äî PUT /bots/{id} (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ webhook URL). API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞.

### –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫-—Å–æ–±—ã—Ç–∏–µ

1. –ü–æ–ª—É—á–∏ POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–≤–æ–π Webhook URL
2. –ü—Ä–æ–≤–µ—Ä—å –ø–æ–¥–ø–∏—Å—å (Signing secret) –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. –ü—Ä–æ–≤–µ—Ä—å webhook_timestamp ‚Äî –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 1 –º–∏–Ω—É—Ç—ã
4. –†–∞–∑–±–µ—Ä–∏ JSON: —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è, –¥–∞–Ω–Ω—ã–µ
5. –î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–¥–µ–ª–∞–π –∑–∞–ø—Ä–æ—Å –∫ API (–Ω–∞–ø—Ä–∏–º–µ—Ä, GET /messages/{id})

> –í–µ–±—Ö—É–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–Ω–∏–º—É–º –¥–∞–Ω–Ω—ã—Ö. –î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π API.

### –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫ (unfurling)

1. –°–æ–∑–¥–∞–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ Unfurl-–±–æ—Ç–∞ –∏ —É–∫–∞–∂–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –¥–æ–º–µ–Ω—ã –≤ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
2. –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å—Å—ã–ª–∫–∏ –±–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç –≤–µ–±—Ö—É–∫ event: "link_shared" —Å –º–∞—Å—Å–∏–≤–æ–º links (url + domain) –∏ message_id
3. –ò–∑–≤–ª–µ–∫–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–≤–æ–µ–π —Å–∏—Å—Ç–µ–º—ã –ø–æ URL –∏–∑ links
4. –û—Ç–ø—Ä–∞–≤—å POST /messages/{message_id}/link_previews —Å –ø—Ä–µ–≤—å—é-–¥–∞–Ω–Ω—ã–º–∏

> –≠–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é. –ù–µ–æ–±—Ö–æ–¥–∏–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π Unfurl-–±–æ—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏.

### –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ (callback)

1. –ü–æ–ª—É—á–∏ –≤–µ–±—Ö—É–∫ —Å event: "message_button_clicked" ‚Äî –≤ payload: data (–∏–∑ –∫–Ω–æ–ø–∫–∏), user_id, message_id
2. –í—ã–ø–æ–ª–Ω–∏ –Ω—É–∂–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–∑–∞–ø–∏—Å—å –≤ –ë–î, –∑–∞–ø—Ä–æ—Å –∫ API –∏ —Ç.–¥.)
3. –û—Ç–≤–µ—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: POST /messages —Å entity_type: "user", entity_id: user_id –∏–∑ –≤–µ–±—Ö—É–∫–∞
4. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ–±–Ω–æ–≤–∏ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ PUT /messages/{message_id} (—É–±–µ—Ä–∏ –∫–Ω–æ–ø–∫–∏ –∏–ª–∏ –∏–∑–º–µ–Ω–∏ —Ç–µ–∫—Å—Ç)

```json
// –ü—Ä–∏–º–µ—Ä payload –≤–µ–±—Ö—É–∫–∞
{
  "type": "message_button_clicked",
  "data": "approve_request_42",
  "user_id": 186,
  "message_id": 154332686
}
```

> –ö–Ω–æ–ø–∫–∞ —Å data –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ –Ω–∞ –≤–µ–±—Ö—É–∫. –ö–Ω–æ–ø–∫–∞ —Å url ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É (–≤–µ–±—Ö—É–∫–∞ –Ω–µ –±—É–¥–µ—Ç).

### –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –¥–∞–π–¥–∂–µ—Å—Ç/–æ—Ç—á—ë—Ç

1. –ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron/scheduler): —Å–æ–±–µ—Ä–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–≤–æ–µ–π —Å–∏—Å—Ç–µ–º—ã
2. –°—Ñ–æ—Ä–º–∏—Ä—É–π —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å –Ω—É–∂–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏–ª–∏ —Å–≤–æ–¥–∫–æ–π
3. POST /messages —Å entity_id: chat_id –Ω—É–∂–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞

```bash
# –ü—Ä–∏–º–µ—Ä: –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç –≤ –∫–∞–Ω–∞–ª #analytics (chat_id: 12345)
curl "https://api.pachca.com/api/shared/v1/messages" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"message":{"entity_id":12345,"content":"üìä –û—Ç—á—ë—Ç –∑–∞ –¥–µ–Ω—å:\n- –ü—Ä–æ–¥–∞–∂–∏: 42\n- –ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 7"}}'
```

> –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π cron, celery, sidekiq –∏ —Ç.–ø. –Ω–∞ —Å–≤–æ–µ–π —Å—Ç–æ—Ä–æ–Ω–µ.

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

1. –í–Ω–µ—à–Ω—è—è —Å–∏—Å—Ç–µ–º–∞ (CI, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —Å–µ—Ä–≤–∏—Å) –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ (–æ—à–∏–±–∫–∞, –¥–µ–ø–ª–æ–π, –ø–æ—Ä–æ–≥ –º–µ—Ç—Ä–∏–∫–∏)
2. –î–µ–ª–∞–µ—Ç POST –∑–∞–ø—Ä–æ—Å –∫ —Ç–≤–æ–µ–º—É –±–æ—Ç—É –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞–µ—Ç Pachca API
3. POST /messages –≤ –∫–∞–Ω–∞–ª –∞–ª–µ—Ä—Ç–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å–æ–±—ã—Ç–∏—è –∏ –∫–Ω–æ–ø–∫–∞–º–∏ ¬´–í–∑—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É¬ª / ¬´–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å¬ª
4. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ ‚Äî –æ–±—Ä–∞–±–æ—Ç–∞–π callback (—à–∞–≥ –≤—ã—à–µ) –∏ –æ–±–Ω–æ–≤–∏ —Å—Ç–∞—Ç—É—Å –∞–ª–µ—Ä—Ç–∞

```bash
curl "https://api.pachca.com/api/shared/v1/messages" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"message":{"entity_id":99901,"content":"üî¥ Production down: —Å–µ—Ä–≤–∏—Å payments –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω","buttons":[[{"text":"–í–∑—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É","data":"alert_ack_501"},{"text":"–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å","data":"alert_ignore_501"}]]}}'
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

| –ö–æ–¥ | –ü—Ä–∏—á–∏–Ω–∞ | –ß—Ç–æ –¥–µ–ª–∞—Ç—å |
|-----|---------|------------|
| 422 | –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | –ü—Ä–æ–≤–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è, —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö, –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è enum |
| 429 | Rate limit | –ü–æ–¥–æ–∂–¥–∏ –∏ –ø–æ–≤—Ç–æ—Ä–∏. –õ–∏–º–∏—Ç: ~50 req/sec, —Å–æ–æ–±—â–µ–Ω–∏—è ~4 req/sec |
| 403 | –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ | –ë–æ—Ç –Ω–µ –≤ —á–∞—Ç–µ, –∏–ª–∏ endpoint —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤/–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ |
| 404 | –ù–µ –Ω–∞–π–¥–µ–Ω–æ | –ù–µ–≤–µ—Ä–Ω—ã–π id. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Å—É—â–Ω–æ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç |
| 401 | –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω | –ü—Ä–æ–≤–µ—Ä—å —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization |

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

`PUT /bots/{id}`

```json
{
  "bot": {
    "webhook": {
      "outgoing_url": "https://www.website.com/tasks/new"
    }
  }
}
```

### Unfurl (—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫)

`POST /messages/{id}/link_previews`

```json
{
  "link_previews": {}
}
```

### –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π

`GET /webhooks/events`

### –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è

`DELETE /webhooks/events/{id}`

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ gotchas

- `limit`: –º–∞–∫—Å–∏–º—É–º 50
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è: cursor-based (limit + cursor), –ù–ï page-based

## –ü–æ–¥—Ä–æ–±–Ω–µ–µ

—Å–º. [references/endpoints.md](references/endpoints.md)
